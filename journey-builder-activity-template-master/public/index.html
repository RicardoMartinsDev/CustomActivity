<!DOCTYPE html>
<html>

<head>
    <title></title>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="css/styles.css">
    <script type="text/javascript" src="js/require.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript">
        (function () {
            var config = {
                baseUrl: 'js'
            };

            var dependencies = [
                'customActivity'
            ];

            require(config, dependencies);
        })();
		
		
		//GET ACESS TOKEN
		var bodyText = {
		"grant_type":"client_credentials",
		"client_id":"cfly1ym6xx6y34jbqw0idypq",
		"client_secret":"FXaTXByn5UyO7r1equQ8OwxU"
		};
		var $j = jQuery.noConflict();
		var $a = jQuery.noConflict();
		var token;
		$j.support.cors = true;
		$j.ajax({
		type: "POST",
		url: "https://cors-anywhere.herokuapp.com/https://mcdgsnqlh4ybg-9cyt895ypwkxh0.auth.marketingcloudapis.com//v2/token",
		headers: {
			'Origin' : 'https://mcdgsnqlh4ybg-9cyt895ypwkxh0.auth.marketingcloudapis.com//v2/token',
			'Access-Control-Allow-Headers' : 'Content-Type, Authorization, Content-Length, X-Requested-With',
			'Access-Control-Allow-Origin' : '*',
			'Access-Control-Allow-Methods' : 'GET, POST, PUT',
			'Content-Type': 'application/json'
		},
		crossDomain: true,
		data: JSON.stringify(bodyText),
		dataType: 'json',
		success: function(responseData, status, xhr) {
			console.log(responseData);
			token = JSON.parse(JSON.stringify(responseData));
			console.log(token.access_token);
		},
		error: function(request, status, error) {
			console.log(request.responseText);
		}
		});
	//END OF TOKEN PARSE
	
	
	
	
	
	/* CREATE CONTACT */
	var bodyTextContact = {
    "ContactKey": "NSFBLK6BD9A651B4EB94F4D10F5E1852EB86DFEBAE683C20190621",
    "EventDefinitionKey":"APIEvent-9306fa8d-3bde-3eca-7845-8177900850a1",
    "EstablishContactKey": true,
    "Data": {
    	"ID_MKTCLOUD": "NSFBLK6BDD9rA650B34EB934F4D10F5E1852EB86DFEBAE683C20190621",
        "SFS_CLIENT_ID": "6BD9A650B4EB94F4D10F5E1852EB86DFEBAE683C", 
               "MSG_CODE": "DNHGAME", 
               "TELEMOVEL": "351916665769", 
               "PAIS": "PT",
                 "AUTH_TIMESTAMP" : "2019-06-21T01:22:00", 
               "TRX_CODE" : "T.R1.Q", 
               "TRX_TYPE" : "Compra", 
               "MERCHANT_NAME" : "UBER TRIP HELP.UBER.CO", 
               "ORG_AMOUNT" : "1.27", 
               "ORG_CURRENCY" : "EUR", 
               "SET_AMOUNT" : "1.27", 
               "OTB_AMOUNT" : "0", 
               "CL_STATUS" : "Payment Delay", 
               "CARD_STATUS" : "0", 
               "ATM_ENTITY" : "20601", 
               "ATM_REFERENCE" : "294876718", 
               "AUTH_ID" : "7072209460", 
               "NOME" : "Nilza", 
               "APELIDO" : "Costa"
    }
};
		var $j = jQuery.noConflict();
		$j.support.cors = true;
		$j.ajax({
		type: "POST",
		url: "https://cors-anywhere.herokuapp.com/https://mcdgsnqlh4ybg-9cyt895ypwkxh0.rest.marketingcloudapis.com/interaction/v1/events",
		headers: {
			'Origin' : 'https://mcdgsnqlh4ybg-9cyt895ypwkxh0.rest.marketingcloudapis.com/interaction/v1/events',
			'Access-Control-Allow-Headers' : 'Content-Type, Authorization, Content-Length, X-Requested-With',
			'Access-Control-Allow-Origin' : '*',
			'Access-Control-Allow-Methods' : 'GET, POST, PUT',
			'Content-Type': 'application/json',
			'Authorization' : 'Bearer ' + token.access_token
		},
		data: JSON.stringify(bodyTextContact),
		dataType: 'json',
		success: function(responseData, status, xhr) {
			console.log(responseData);
		},
		error: function(request, status, error) {
			console.log(request.responseText);
		}
		});
		/*end of contact creation*/
    </script>
</head>

<body>
    <div id="step1" class="step">
        <div class="slds-grid">

            <main class="slds-col">
               
                <h1>Chama API com dados</h1>
            </main>
            

        </div>

    </div>
</body>

</html>
